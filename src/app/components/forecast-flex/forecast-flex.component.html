<mat-card
  class="forecast-card"
  [ngSwitch]="loadingError"
  [ngStyle]="{ 'background-color': cardBackground }"
>
  <div fxLayout="column" fxFill class="content" *ngSwitchCase="true">
    <h3>Connection or service problem. Please reload or try later.</h3>
  </div>
  <div fxLayout="column" fxFill class="content" *ngSwitchCase="false">
    <!-- A row of Day/Date & Hours columns-->
    <div fxFlex fxLayout="row" [fxHide]="loadingOwmData">
      <!-- Day/Date column-->
      <div
        class="table-column_0"
        fxLayout="column"
        [ngStyle]="{ color: dateColumnTextColor }"
      >
        <div
          fxFlex="10%"
          fxFlex.gt-xs="5%"
          fxLayout="column"
          class="table-cell_00"
          fxLayoutAlign="center"
        >
          <!-- removed in favour of empty box -->
          <!--
          <span fxLayoutAlign="end center">Hour</span>
          <span fxFlex fxLayoutAlign="center center"></span>
          <span fxLayoutAlign="start start">Date</span>
        --></div>

        <div fxFlex fxLayout="column" id="daycolumn">
          <div
            fxFlex
            fxLayoutAlign="start center"
            class="table-cell_date"
            *ngFor="
            let dataDaily of weatherData?.listByDate | keyvalue;
            index as $index
            "
            >
            <span fxLayout="column" fxLayoutAlign="end center">
              <span>{{ dataDaily.key | date: 'EEE' }}</span>
              <span>{{ dataDaily.key | date: 'dd' }}</span>
              <span>{{ dataDaily.key | date: 'MMM' }}</span>
            </span>
          </div>
        </div>
      </div>
      <!-- / Day/Date column-->

      <!-- Hours columns-->
      <div fxFlex fxFill fxLayout="column" class="scroll-this">
        <div fxFlex="10%" fxFlex.gt-xs="5%" fxLayout="row">
          <span
            fxFlex
            fxLayoutAlign="center center"
            class="table-header-background"
            *ngFor="let timeSlot of timeTemplate; index as ind"
            [ngStyle]="{
              'background-color': timeTemplate[ind].bgColor,
              color: timeTemplate[ind].textColor,
              border:
                (isCurrentTimeSlot(timeSlot) ? '1' : '0') + 'px solid black'
            }"
          >
            {{ (timeSlot.hour > 9 ? '' : '0') + timeSlot.hour + ':00' }}
          </span>
        </div>
        <!-- show a row for each day -->
        <div
          fxFlex
          *ngFor="let dataDaily of weatherData?.listByDate | keyvalue"
          [@showTimeSlot]="listByDateLength * timeTemplate.length"
          >
          <!-- show each timeslot in the day's row -->
          <span
            fxFlex
            fxLayout="row"
            *ngFor="let timeSlot of timeTemplate; index as ind"
          >
            <span
              fxFlex
              class="table-cell_data_empty-background"
              *ngIf="!dataDaily.value[timeSlot.hour]"
            ></span>
            <span
              fxFlex
              *ngIf="dataDaily.value[timeSlot.hour]"
              class="table-cell_data-background"
              [ngStyle]="{
                'background-color': timeTemplate[ind].bgColor,
                color: timeTemplate[ind].textColor,
                border:
                  (isCurrentTimeSlot(timeSlot) ? '1' : '0') + 'px solid black'
              }"
              fxLayout="column"
              fxLayoutAlign="center center"
            >
              <div fxFlex="25%" fxLayout="row" fxLayoutAlign="center center">
                <img
                  [src]="
                    iconsOwm +
                    dataDaily.value[timeSlot.hour].weather[0].icon +
                    '.png'
                  "
                />
                {{ dataDaily.value[timeSlot.hour].weather[0].main }}
                {{
                  dataDaily.value[timeSlot.hour].main.temp | number: '1.0-0'
                }}&#176;C
              </div>

              <div fxFlex fxLayout="column">
                <span
                  fxFlex="25%"
                  fxLayout="row"
                  fxLayoutAlign="start end"
                  class="table-secondary_data_line"
                >
                  <img [src]="iconPressure" />
                  <span fxFill class="table-secondary_data-opacity">
                    <span fxFlex="50%" fxLayoutAlign="end end">
                      &nbsp;{{
                        dataDaily.value[timeSlot.hour].main.pressure
                          | number: '1.0-0'
                      }}
                    </span>
                    <span fxFlex fxLayoutAlign="start end">
                      &nbsp;<small>hPa</small>
                    </span>
                  </span>
                </span>

                <span
                  fxFlex="25%"
                  fxLayout="row"
                  fxLayoutAlign="start end"
                  class="table-secondary_data_line"
                >
                  <img [src]="iconWind" />
                  <span
                    fxFill
                    class="table-secondary_data-opacity"
                    fxLayout="row"
                  >
                    <span fxFlex="50%" fxLayoutAlign="end end">
                      <span
                        fxFlex
                        fxFill
                        fxLayoutAlign="center center"
                        [ngStyle]="{ height: '50%', 'min-height': '50%', 'font-weight': 'bold'}"
                        [style.transform]="
                          'rotate(' +
                          dataDaily.value[timeSlot.hour].wind.deg +
                          'deg)'
                        "
                      >
                        {{ arrow000Deg }}
                      </span>
                      {{
                        dataDaily.value[timeSlot.hour].wind.speed
                          | number: '1.0-0'
                      }}
                    </span>
                    <span fxFlex fxLayoutAlign="start end">
                      &nbsp;<small>m/s</small>
                    </span>
                  </span>
                </span>

                <span
                  fxFlex="25%"
                  fxLayout="row"
                  fxLayoutAlign="start end"
                  class="table-secondary_data_line"
                >
                  <img [src]="iconHumidity" />
                  <span fxFill class="table-secondary_data-opacity">
                    <span fxFlex="50%" fxLayoutAlign="end end">
                      &nbsp;{{
                        dataDaily.value[timeSlot.hour].main.humidity
                          | number: '1.0-0'
                      }}
                    </span>
                    <span fxFlex fxLayoutAlign="start end">
                      &nbsp;<small>%</small>&nbsp;
                    </span>
                  </span>
                </span>
              </div>
            </span>
          </span>
        </div>
      </div>
      <!-- Hours columns-->
    </div>
    <div
      fxFlex
      fxLayout="column"
      fxLayoutAlign="center center"
      *ngIf="loadingOwmData"
    >
      <mat-spinner diameter="50"></mat-spinner>
    </div>
  </div>
</mat-card>
